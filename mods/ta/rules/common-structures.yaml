# 建造厂
fact:
	Inherits: ^BaseBuilding
	Inherits@shape: ^4x4Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 1000
		Prerequisites: ~disabled
		Description: Builds structures
	Building:
		Footprint: xxxx xxxx xxxx xxxx
		Dimensions: 4,4
	Selectable:
		Bounds: 220, 155, 0, -20
	Health:
		HP: 1000
	Armor:
		Type: Concrete
	RevealsShroud:
		Range: 10c0
	Valued:
		Cost: 3500
	Production:
		Produces: Building, Support
	Tooltip:
		Name: Construction Yard
	BaseBuilding:
	BaseProvider:
		Range: 0
	Transforms:
		IntoActor: mcv
		Offset: 1,1
		Facing: 96
		DeployCursor: undeploy
		RequiresCondition: factundeploy && !build-incomplete
	TransformsIntoMobile:
		RequiresCondition: factundeploy
		Locomotor: heavytracked
		Voice: Move
		RequiresForceMove: true
	TransformsIntoRepairable:	# 修改修复平台名称
		RequiresCondition: factundeploy
		RepairActors: gadept, nadept, caoutp
		Voice: Move
		RequiresForceMove: true
	TransformsIntoPassenger:
		RequiresCondition: factundeploy
		CargoType: Vehicle
		Voice: Move
		RequiresForceMove: true
	TransformsIntoTransforms:
		RequiresCondition: factundeploy && build-incomplete
	GrantConditionOnPrerequisite@GLOBALFACTUNDEPLOY:
		Condition: factundeploy
		Prerequisites: global-factundeploy
	ProductionBar@Building:
		ProductionType: Building
	ProductionBar@Support:
		ProductionType: Support
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	WithIdleOverlay@fans:
		Sequence: idle-fans
		PauseOnCondition: lowpower || build-incomplete
		RequiresCondition: !build-incomplete
	WithBuildingPlacedOverlay:
	ProvidesPrerequisite@gdi:
		Factions: gdi
		Prerequisite: structures.gdi
	ProvidesPrerequisite@nod:
		Factions: nod
		Prerequisite: structures.nod
	ProvidesPrerequisite@default:
		Prerequisite: structures.any
	Power:
		Amount: 0
	SpawnActorsOnSell@allies: # TIDO: 移除多余的出售单位
		ActorTypes: e1, e1, e1, engineer
		Factions: america, germany, england, france, korea
	SpawnActorsOnSell@soviets:
		ActorTypes: e2, e2, e2, e2, engineer
		Factions: cuba, libya, iraq, russia
	SpawnActorsOnSell@gdi:
		ActorTypes: e1, e1, e1, engineer
		Factions: gdi
	SpawnActorsOnSell@nod:
		ActorTypes: e2, e2, e2, e2, engineer
		Factions: nod
	RenderSprites:  # TODO: 素材..
		Image: gacnst

pwrplt:
	Inherits: ^BaseBuilding
	Inherits@shape: ^2x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 基础发电设施
	Selectable:
		Bounds: 252, 188, 4, -32
	Valued:
		Cost: 500
	Tooltip:
		Name: 发电厂
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: xx xx xx
		Dimensions: 2,3
	Health:
		HP: 750
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@glow:
		Sequence: idle-glow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 100
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: pwrplt
		PlayerPalette: green_unit

advpwr:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 高级发电设施
	Selectable:
		Bounds: 252, 188, 4, -32
	Valued:
		Cost: 800
	Tooltip:
		Name: 高级发电厂
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: xx= xxx =x=
		Dimensions: 3,3
	Health:
		HP: 1250
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@glow:
		Sequence: idle-glow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 200
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: advpwr
		PlayerPalette: green_unit

hq:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 开启雷达并提供T2科技
	Selectable:
		Bounds: 252, 188, 4, -32
	Valued:
		Cost: 1000
	Tooltip:
		Name: 指挥中心
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: =x= xxx =x=
		Dimensions: 3,3
	Health:
		HP: 1250
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@dish:
		Sequence: idle-dish
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@fans:
		Sequence: idle-fans
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 100
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: hq
		PlayerPalette: green_unit


advhq:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 开启雷达并提供T3科技
	Selectable:
		Bounds: 252, 188, 4, -32
	Valued:
		Cost: 2000
	Tooltip:
		Name: 高级指挥中心
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: =x= xxx =x=
		Dimensions: 3,3
	Health:
		HP: 2000
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@dish:
		Sequence: idle-dish
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@fans:
		Sequence: idle-fans
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 100
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: advhq
		PlayerPalette: green_unit


refinery:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x4Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 收集并精炼泰伯利亚晶矿
	Selectable:
		Bounds: 252, 188, 4, -32
	Valued:
		Cost: 1500
	Tooltip:
		Name: 精炼厂
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: xx= xxx x=x ===
		Dimensions: 3,4
	Health:
		HP: 1500
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@lights:
		Sequence: idle-lights
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@liquid:
		Sequence: idle-liquid
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@arrow:
		Sequence: idle-arrow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 200
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: refinery
		PlayerPalette: green_unit

repairdepot:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 消耗资金维修机械
	Selectable:
		Bounds: 144, 88, 5, 0
	Valued:
		Cost: 2000
	Tooltip:
		Name: 维修平台
	ProvidesPrerequisite:
	Reservable:
	RepairsUnits:
		HpPerStep: 20
		FinishRepairingNotification: UnitRepaired
		PlayerExperience: 15
	RallyPoint:
		Palette: mouse
		IsPlayerPalette: false
	Building:
		Footprint: === === ===
		Dimensions: 3,3
	Health:
		HP: 500
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithRepairOverlay@PLATFORM:
		Sequence: padglow
		RequiresCondition: !Building-Buildup
	Power:
		Amount: -30
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure
	RenderSprites:
		Image: repairdepot
		PlayerPalette: green_unit