# 建造厂
fact:
	Inherits: ^BaseBuilding
	Inherits@shape: ^4x4Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 1000
		Prerequisites: ~disabled
		Description: Builds structures
	Building:
		Footprint: xxxx xxxx xxxx xxxx
		Dimensions: 4,4
	Selectable:
		Bounds: 120, 53, 0, -5
	Health:
		HP: 2100
	Armor:
		Type: Concrete
	RevealsShroud:
		Range: 10c0
	Valued:
		Cost: 3500
	Production:
		Produces: Building, Support
	Tooltip:
		Name: Construction Yard
	BaseBuilding:
	BaseProvider:
		Range: 0
	Transforms:
		IntoActor: mcv
		Offset: 1,1
		Facing: 96
		DeployCursor: undeploy
		RequiresCondition: factundeploy && !build-incomplete
	TransformsIntoMobile:
		RequiresCondition: factundeploy
		Locomotor: heavytracked
		Voice: Move
		RequiresForceMove: true
	TransformsIntoRepairable:	# 修改修复平台名称
		RequiresCondition: factundeploy
		RepairActors: gadept, nadept, caoutp
		Voice: Move
		RequiresForceMove: true
	TransformsIntoPassenger:
		RequiresCondition: factundeploy
		CargoType: Vehicle
		Voice: Move
		RequiresForceMove: true
	TransformsIntoTransforms:
		RequiresCondition: factundeploy && build-incomplete
	GrantConditionOnPrerequisite@GLOBALFACTUNDEPLOY:
		Condition: factundeploy
		Prerequisites: global-factundeploy
	ProductionBar@Building:
		ProductionType: Building
	ProductionBar@Support:
		ProductionType: Support
	GrantConditionOnPowerState@LOWPOWER:
		Condition: lowpower
		ValidPowerStates: Low, Critical
	WithIdleOverlay@fans:
		Sequence: idle-fans
		PauseOnCondition: lowpower || build-incomplete
		RequiresCondition: !build-incomplete
	WithBuildingPlacedOverlay:
	ProvidesPrerequisite@gdi:
		Factions: gdi
		Prerequisite: structures.gdi
	ProvidesPrerequisite@nod:
		Factions: nod
		Prerequisite: structures.nod
	ProvidesPrerequisite@default:
		Prerequisite: structures.any
	Power:
		Amount: 0
	SpawnActorsOnSell@gdi:
		ActorTypes: e1, e1, e1, engineer
		Factions: gdi
	SpawnActorsOnSell@nod:
		ActorTypes: e2, e2, e2, e2, engineer
		Factions: nod
	RenderSprites:  # TODO: 素材..
		Image: gacnst
	Targetable@materials:
		TargetTypes: Metel

pwrplt:
	Inherits: ^BaseBuilding
	Inherits@shape: ^2x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 10
		Prerequisites: structures.any
		Description: 基础发电设施, 为基地其他建筑提供电力
	Selectable:
		Bounds: 134, 102, -10, -21
	Valued:
		Cost: 500
	Tooltip:
		Name: 发电厂
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: xx xx xx
		Dimensions: 2,3
	Health:
		HP: 550
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@glow:
		Sequence: idle-glow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 100
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable@materials:
		TargetTypes: Metel
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: pwrplt
		PlayerPalette: green_unit

advpwr:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 80
		Prerequisites: hq, ~techlevel.medium
		Description: 高级发电设施, 效率是普通发电厂的两倍
	Selectable:
		Bounds: 134, 102, -10, -21
	Valued:
		Cost: 800
	Tooltip:
		Name: 高级发电厂
	ProvidesPrerequisite:
		Prerequisite: power
	Building:
		Footprint: xx= xxx =x=
		Dimensions: 3,3
	Health:
		HP: 700
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithIdleOverlay@glow:
		Sequence: idle-glow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: 200
		RequiresCondition: !power-outage
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: advpwr
		PlayerPalette: green_unit
	Targetable@materials:
		TargetTypes: Metel


refinery:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x4Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 20
		Prerequisites: power
		Description: 收集并精炼泰伯利亚晶矿以获取资金\n\n·可以储存1000单位泰伯利亚晶体
	Selectable:
		Bounds: 200, 148, 4, -32
	Tooltip:
		Name: 精炼厂
	ProvidesPrerequisite:
		Prerequisite: refinery
	Building:
		Footprint: xx= xxx xxx ===
		Dimensions: 3,4
	Valued:
		Cost: 1500
	CustomSellValue:
		Value: 500
	Power:
		Amount: -40
	StoresResources:
		PipColor: Green
		PipCount: 10
		Capacity: 1000
	Refinery:
		ShowTicks: True
		TickLifetime: 30
		TickVelocity: 1
		TickRate: 10
		UseStorage: True
		DockAngle: 96
		DockOffset: 1, 3 #1,2
	FreeActor:
		Actor: harvester
		SpawnOffset: 1,3
		Facing: 96
	Health:
		HP: 1500
	Armor:
		Type: Concrete
	RevealsShroud:
		Range: 4c0
	WithDockedOverlay:
	WithIdleOverlay@lights:
		Sequence: idle-lights
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@liquid:
		Sequence: idle-liquid
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@arrow:
		Sequence: idle-arrow
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@fans:
		Sequence: idle-fans
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@bib:
		Sequence: bib
		RequiresCondition: !Building-Buildup
		PauseOnCondition: build-incomplete
	InfiltrateForPowerOutage:
		Types: SpyInfiltrate
	AffectedByPowerOutage:
		Condition: power-outage
	ScalePowerWithHealth:
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: refinery
		PlayerPalette: green_unit
	BodyOrientation:
		UseClassicPerspectiveFudge: false
		CameraPitch: 85
	Targetable@materials:
		TargetTypes: Metel

hq:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 70
		Prerequisites: refinery
		Description: 开启雷达并提供高级的生产许可
	Selectable:
		Bounds: 134, 102, -10, -21
	Valued:
		Cost: 1000
	Tooltip:
		Name: 指挥中心
	ProvidesPrerequisite:
		Prerequisite: hq
	Building:
		Footprint: _x_ xxx _x_
		Dimensions: 3,3
	Health:
		HP: 800
	Armor:
		Type: Concrete
	RevealsShroud:
		Range: 10c0
	WithIdleOverlay@dish:
		Sequence: idle-dish
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	WithIdleOverlay@fans:
		Sequence: idle-fans
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	Power:
		Amount: -50
		RequiresCondition: !power-outage
	ProvidesRadar:
		RequiresCondition: !lowpower
	RenderDetectionCircle:
	DetectCloaked:
		Range: 5c0
		RequiresCondition: !lowpower
	PowerTooltip:
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, SpyInfiltrate
	RenderSprites:
		Image: hq
		PlayerPalette: green_unit
	Targetable@materials:
		TargetTypes: Metel
	AirstrikePower@gdi:
		OrderName: A-10Airstrike
		Cursor: attackmove
		PauseOnCondition: lowpower
		Prerequisites: A-10Airstrike.gdi
		Icon: a10_icon
		ChargeInterval: 5000
		SquadSize: 3
		QuantizedFacings: 8
		Description: A-10空袭
		LongDesc: 部署轰炸信标\n对一条直线上的单位与建筑造成伤害
		EndChargeSpeechNotification: AirstrikeReady
		SelectTargetSpeechNotification: SelectTarget
		InsufficientPowerSpeechNotification: InsufficientPower
		IncomingSpeechNotification: EnemyPlanesApproaching
		UnitType: a10b
		DisplayBeacon: True
		BeaconPoster: a10_icon
		# BeaconPosterPalette: beaconposter
		DisplayRadarPing: True
		DisplayTimerStances: Ally, Neutral, Enemy
		CameraActor: camera
		ArrowSequence: arrow
		ClockSequence: clock
		# CircleSequence: circles
		UseDirectionalTarget: True
		DirectionArrowAnimation: arrowdirection
		SupportPowerPaletteOrder: 10
	ParatroopersPower@nod:
		OrderName: Paratroopers
		Icon: para_icon
		ChargeInterval: 7000
		Description: 空降部队
		LongDesc: 派遣AC130炮艇机向目标区域投送空降突击队 \nAC130将在投放部队的同时提供一定的火力支援
		EndChargeSpeechNotification: AirstrikeReady
		SelectTargetSpeechNotification: SelectTarget
		InsufficientPowerSpeechNotification: InsufficientPower
		IncomingSpeechNotification: EnemyPlanesApproaching
		DropItems: mngunner,ncycle,mngunner,mngunner,nbggy
		QuantizedFacings: 8
		UnitType: ac130
		DisplayBeacon: True
		BeaconPoster: para_icon
		# BeaconPosterPalette: beaconposter
		DisplayRadarPing: True
		DisplayTimerStances: Ally, Neutral, Enemy
		CameraActor: camera
		Prerequisites: Paradrops.nod
		ArrowSequence: arrow
		ClockSequence: clock
		# CircleSequence: circles
		UseDirectionalTarget: True
		DirectionArrowAnimation: arrowdirection
		SupportPowerPaletteOrder: 10
	SupportPowerChargeBar:
	ProvidesPrerequisite@gdi:
		Prerequisite: A-10Airstrike.gdi
		Factions: gdi
		ResetOnOwnerChange: true
	ProvidesPrerequisite@nod:
		Prerequisite: Paradrops.nod
		Factions: nod
		ResetOnOwnerChange: true


helipad:
	Inherits: ^BaseBuilding
	Inherits@shape: ^2x2Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 60
		Prerequisites: refinery
		Description: 提供一个可以维修飞行器并为其装弹的停机位。\n开启飞行器建造序列。
	Valued:
		Cost: 800
	Tooltip:
		Name: 停机坪
	ProvidesPrerequisite:
		Prerequisite: helipad
	ProvidesPrerequisite@gdi:
		Prerequisite: aircraft.gdi
		Factions: gdi
	ProvidesPrerequisite@nod:
		Prerequisite: aircraft.nod
		Factions: nod
	ProvidesPrerequisite@default:
		Prerequisite: aircraft.any
	Building:
		Footprint: xx xx
		Dimensions: 2,2
	Selectable:
		Bounds: 120, 53, 0, -5
	Health:
		HP: 600
	Armor:
		Type: Steel
	WithIdleOverlay@anim-lights:
		Sequence: anim-lights
		RequiresCondition: !build-incomplete
		PauseOnCondition: build-incomplete
	RevealsShroud:
		Range: 5c0
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure
	Power:
		Amount: -10
	Reservable:
	Exit@1:
		SpawnOffset: 0,-256,0
	Production:
		Produces: Aircraft
	ProductionBar:
		ProductionType: Aircraft
	PrimaryBuilding:
		PrimaryCondition: primary
		SelectionNotification: PrimaryBuildingSelected
	WithTextDecoration@primary:
		RequiresSelection: true
		Text: PRIMARY
		ReferencePoint: Top
		ZOffset: 256
		RequiresCondition: primary
	InfiltrateForExploration:
		Types: SpyInfiltrate
	Targetable@materials:
		TargetTypes: Metel


repairdepot:
	Inherits: ^BaseBuilding
	Inherits@shape: ^3x3Shape
	Buildable:
		Queue: Building
		BuildPaletteOrder: 60
		Prerequisites: vehicle_factory
		Description: 消耗资金来快速维修载具与飞行器
	Selectable:
		Bounds: 144, 88, 5, 0
	Valued:
		Cost: 500
	Tooltip:
		Name: 维修平台
	ProvidesPrerequisite:
		Prerequisite: repairdepot
	Reservable:
	RepairsUnits:
		HpPerStep: 20
		FinishRepairingNotification: UnitRepaired
		PlayerExperience: 15
	RallyPoint:
		Palette: mouse
		IsPlayerPalette: false
	Building:
		Footprint: === === ===
		Dimensions: 3,3
	Health:
		HP: 500
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	WithRepairOverlay@PLATFORM:
		Sequence: padglow
		RequiresCondition: !Building-Buildup
	Power:
		Amount: -30
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure
	RenderSprites:
		Image: repairdepot
		PlayerPalette: green_unit
	Targetable@materials:
		TargetTypes: Metel

silo:
	Inherits: ^SupportBuilding
	Inherits@shape: ^2x2Shape
	Buildable:
		Queue: Support
		BuildPaletteOrder: 10
		Prerequisites: refinery
		Description: 储存1000单位泰伯利亚晶体
	Selectable:
		Bounds: 120, 53, 0, -5
	Valued:
		Cost: 200
	Tooltip:
		Name: 泰伯利亚储仓
	Building:
		Footprint: xx xx
		Dimensions: 2,2
	Health:
		HP: 100
	Armor:
		Type: Wood
	RevealsShroud:
		Range: 4c0
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure
	RenderSprites:
		Image: silo
		PlayerPalette: silo
	StoresResources:
		PipColor: Green
		PipCount: 15
		Capacity: 1000
	Targetable@materials:
		TargetTypes: Metel

